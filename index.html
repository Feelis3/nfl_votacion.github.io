<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NFL 2026 Playoffs</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --bg: #050505;
            --surface: #141414;
            --surface-light: #1f1f1f;
            --border: #2a2a2a;
            --text-main: #ffffff;
            --text-sub: #888888;
            --accent: #00e676; /* Verde Ne칩n para ganadores */
            --accent-gradient: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            --danger: #ef4444;
            --gold: #eab308;
            --nav-height: 65px;
            --td-color: #10b981;
            --fg-color: #3b82f6;
            --sf-color: #ef4444;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { font-family: 'Outfit', sans-serif; background: var(--bg); margin: 0; color: var(--text-main); padding-bottom: calc(var(--nav-height) + 20px); -webkit-font-smoothing: antialiased; }

        /* --- NUEVO HEADER DISE칌O BROADCAST --- */
        header {
            background: #080808;
            background: linear-gradient(180deg, #0f0f0f 0%, #050505 100%);
            height: 72px;
            padding: 0 20px;
            position: sticky; top: 0; z-index: 100;
            border-bottom: 1px solid #222;
            display: flex; justify-content: space-between; align-items: center;
            box-shadow: 0 4px 20px rgba(0,0,0,0.6);
        }
        
        /* Efecto de linea brillante abajo */
        header::after {
            content: ''; position: absolute; bottom: -1px; left: 0; width: 100%; height: 1px;
            background: linear-gradient(90deg, transparent 0%, #3b82f6 50%, transparent 100%);
            opacity: 0.7;
        }

        .header-brand {
            display: flex; align-items: center; gap: 12px;
        }
        
        .nfl-icon-box {
            font-size: 1.8rem; color: white;
            filter: drop-shadow(0 0 10px rgba(59, 130, 246, 0.4));
        }

        .header-titles {
            display: flex; flex-direction: column; justify-content: center;
        }

        .ht-main {
            font-weight: 900; font-size: 1.2rem; color: white; 
            text-transform: uppercase; font-style: italic;
            line-height: 1; letter-spacing: 0.5px;
        }
        
        .ht-sub {
            font-size: 0.65rem; color: #3b82f6; font-weight: 800;
            text-transform: uppercase; letter-spacing: 2px;
            margin-top: 2px;
        }

        /* LIVE PULSE INDICATOR */
        .live-pill {
            display: flex; align-items: center; gap: 8px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid #333;
            padding: 6px 12px; border-radius: 30px;
        }
        
        .live-dot {
            width: 8px; height: 8px; background: var(--accent); border-radius: 50%;
            box-shadow: 0 0 8px var(--accent);
            animation: livePulse 1.5s infinite;
        }
        
        .live-txt {
            font-size: 0.7rem; font-weight: 800; color: white; letter-spacing: 1px;
        }

        @keyframes livePulse {
            0% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(1.2); }
            100% { opacity: 1; transform: scale(1); }
        }

        /* LAYOUT */
        .container { max-width: 800px; margin: 0 auto; padding: 15px; }
        .section { display: none; animation: fadeUp 0.4s cubic-bezier(0.16, 1, 0.3, 1); }
        .section.active { display: block; }
        @keyframes fadeUp { from { opacity:0; transform:translateY(15px); } to { opacity:1; transform:translateY(0); } }

        /* BRACKET SYSTEM - MODERN */
        .conf-header-row { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 25px; }
        .conf-badge { 
            padding: 15px; border-radius: 12px; background: var(--surface); border: 1px solid var(--border);
            display: flex; justify-content: center; align-items: center; position: relative; overflow: hidden;
        }
        .conf-badge::before { content:''; position: absolute; top:0; left:0; width:100%; height:3px; }
        .afc-bg::before { background: #d50a0a; } .nfc-bg::before { background: #013369; }
        .conf-logo-img { height: 40px; width: auto; object-fit: contain; }

        /* ESPACIO AUMENTADO ENTRE RONDAS */
        .round-wrapper { margin-bottom: 50px; }
        
        .round-title { text-align: center; color: var(--text-sub); font-size: 0.75rem; text-transform: uppercase; letter-spacing: 2px; margin-bottom: 12px; font-weight: 800; }
        .matches-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; } 
        
        .match-card { 
            background: var(--surface); border: 1px solid var(--border); border-radius: 12px; 
            overflow: hidden; margin-bottom: 12px; display: flex; flex-direction: column;
            transition: transform 0.2s; 
        }
        .match-card:active { transform: scale(0.98); }
        
        .team-row {
            display: flex; align-items: center; padding: 10px 12px; height: 56px;
            border-bottom: 1px solid var(--border); cursor: default;
            opacity: 0.5; filter: grayscale(100%); transition: all 0.3s;
        }
        .team-row:last-child { border-bottom: none; }
        
        /* ESTILO ACTIVO (PENDIENTE) - COLOR DEL EQUIPO */
        .team-row.active-team { 
            opacity: 1; filter: grayscale(0%); 
            background: linear-gradient(90deg, rgba(255,255,255,0.03) 0%, transparent 100%); 
            border-left: 3px solid var(--team-color); 
        }

        /* ESTILO GANADOR (VERDE) */
        .team-row.winner-green {
            opacity: 1; filter: grayscale(0%);
            background: linear-gradient(90deg, rgba(0, 230, 118, 0.15) 0%, transparent 100%) !important;
            border-left: 3px solid var(--accent) !important;
        }
        .team-row.winner-green .team-name { color: var(--accent); font-weight: 800; text-shadow: 0 0 10px rgba(0,230,118,0.4); }
        .team-row.winner-green .team-seed { background: none; }
        
        .team-seed { font-size: 0.7rem; font-weight: 700; color: #666; width: 20px; margin-right: 8px; }
        .team-logo { width: 30px; height: 30px; object-fit: contain; margin-right: 10px; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3)); }
        .team-name { font-size: 0.9rem; font-weight: 600; color: white; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        
        /* ICONO TROFEO SEPARADO */
        .status-icon { margin-left: 12px; color: var(--gold); font-size: 0.9rem; }
        
        .ph-box { padding: 20px; text-align: center; color: #444; font-size: 0.75rem; border: 1px dashed #333; border-radius: 12px; background: rgba(255,255,255,0.02); }

        /* LIVE MATCHES */
        .live-card {
            background: var(--surface); border-radius: 16px; overflow: hidden; border: 1px solid var(--border); 
            margin-bottom: 16px; cursor: pointer; position: relative; box-shadow: 0 4px 20px rgba(0,0,0,0.2);
        }
        .live-card.red-zone-active { border: 1px solid var(--danger); box-shadow: 0 0 10px rgba(255, 82, 82, 0.3); }

        .live-header { 
            background: var(--surface-light); padding: 10px 15px; font-size: 0.75rem; color: #aaa; 
            display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--border); 
        }
        .live-status { font-weight: 700; color: white; background: #333; padding: 2px 8px; border-radius: 4px; font-size: 0.65rem; }
        .live-status.in-progress { background: var(--danger); color: white; animation: pulse 2s infinite; }
        @keyframes pulse { 0% {opacity: 1;} 50% {opacity: 0.5;} 100% {opacity: 1;} }
        
        .game-situation { font-size: 0.65rem; color: #3b82f6; font-weight: 900; text-transform: uppercase; margin-right: 8px; }
        .red-zone-text { color: var(--danger); animation: blink 1s infinite; }
        @keyframes blink { 50% { opacity: 0.5; } }

        .live-body { padding: 20px; display: grid; grid-template-columns: 1fr auto 1fr; align-items: center; gap: 15px; }
        .live-team { display: flex; flex-direction: column; align-items: center; gap: 10px; text-align: center; }
        .live-logo { width: 55px; height: 55px; object-fit: contain; filter: drop-shadow(0 4px 8px rgba(0,0,0,0.3)); }
        .live-name { font-size: 1rem; font-weight: 800; color: white; }
        .live-score { font-size: 2rem; font-weight: 900; color: white; letter-spacing: -1px; }
        .live-vs { font-size: 0.8rem; color: #444; font-weight: 700; background: #111; padding: 5px 10px; border-radius: 20px; }

        /* MODAL PARTIDO DETALLES */
        .match-modal-header { padding: 30px 20px; background: linear-gradient(180deg, #1a1a1a 0%, #050505 100%); border-bottom: 1px solid var(--border); text-align: center; }
        .mm-score-board { display: flex; justify-content: space-between; align-items: center; max-width: 400px; margin: 0 auto; }
        .mm-team { display: flex; flex-direction: column; align-items: center; width: 30%; position: relative; }
        .mm-logo-big { width: 80px; height: 80px; object-fit: contain; margin-bottom: 10px; filter: drop-shadow(0 0 20px rgba(255,255,255,0.05)); }
        .mm-name-big { font-weight: 900; font-size: 1.2rem; text-transform: uppercase; letter-spacing: 1px; }
        .mm-score-big { font-size: 3.5rem; font-weight: 800; width: 40%; line-height: 1; }
        .mm-score-pre { font-size: 1.8rem; font-weight: 700; color: #666; letter-spacing: 2px; }
        .mm-weather { margin-top: 15px; display: inline-flex; align-items: center; gap: 8px; background: rgba(255,255,255,0.1); padding: 6px 12px; border-radius: 20px; font-size: 0.75rem; color: #ddd; }
        
        .ball-icon { color: var(--gold); font-size: 1.2rem; position: absolute; top: -10px; right: 10px; animation: bounce 1s infinite; display: none; }
        .has-possession .ball-icon { display: block; }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-5px); } }

        /* ULTIMA JUGADA */
        .last-play-box { 
            background: rgba(59, 130, 246, 0.1); border: 1px solid rgba(59, 130, 246, 0.3); 
            border-radius: 8px; padding: 12px; margin: 20px 20px 0 20px; text-align: left;
        }
        .lp-label { color: #3b82f6; font-size: 0.65rem; font-weight: 800; text-transform: uppercase; margin-bottom: 4px; }
        .lp-text { color: white; font-size: 0.8rem; line-height: 1.3; }

        /* STATS COMPARISON */
        .stats-comparison { padding: 0 20px 20px 20px; }
        .sc-row { margin-bottom: 15px; }
        .sc-label { text-align: center; color: #666; font-size: 0.65rem; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 6px; font-weight: 700; }
        .sc-bars { display: flex; align-items: center; gap: 12px; }
        .sc-val { font-weight: 700; color: white; font-size: 0.85rem; width: 35px; text-align: center; }
        .sc-bar-bg { flex: 1; height: 6px; background: #222; border-radius: 3px; overflow: hidden; display: flex; }
        .sc-fill-home { height: 100%; background: var(--team-a-color); opacity: 0.8; }
        .sc-fill-away { height: 100%; background: var(--team-b-color); opacity: 0.8; }

        .game-leaders { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; padding: 0 20px 20px 20px; }
        .gl-box { 
            background: var(--surface-light); border-radius: 10px; padding: 12px; 
            display: flex; gap: 12px; align-items: center; border: 1px solid var(--border); 
        }
        .gl-img { width: 45px; height: 45px; border-radius: 50%; object-fit: cover; object-position: top; background: #333; border: 2px solid #333; flex-shrink: 0; }
        .gl-info { display: flex; flex-direction: column; overflow: hidden; }
        .gl-name { font-size: 0.8rem; font-weight: 700; color: white; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .gl-stat { font-size: 0.75rem; color: #3b82f6; font-weight: 600; }
        .gl-cat { font-size: 0.6rem; color: #666; text-transform: uppercase; }

        /* SCORING PLAYS */
        .scoring-list { padding: 0 20px 20px 20px; }
        .scoring-item { 
            display: flex; gap: 15px; margin-bottom: 15px; align-items: flex-start; 
            padding-bottom: 15px; border-bottom: 1px solid #222; 
        }
        .si-logo { 
            width: 40px !important; height: 40px !important; min-width: 40px; 
            object-fit: contain; background: #1a1a1a; border-radius: 50%; 
            padding: 4px; border: 1px solid #333; flex-shrink: 0;
        }
        .si-time { font-size: 0.7rem; color: #666; font-weight: 700; width: 40px; flex-shrink: 0; padding-top: 4px; }
        .si-content { flex: 1; display: flex; flex-direction: column; }
        .si-tag { 
            font-size: 0.6rem; font-weight: 800; padding: 3px 8px; border-radius: 4px; 
            display: inline-block; margin-bottom: 4px; color: black; width: fit-content;
        }
        .tag-td { background: var(--td-color); } .tag-fg { background: var(--fg-color); color: white; } .tag-sf { background: var(--sf-color); color: white; }
        .si-text { font-size: 0.85rem; color: #ddd; line-height: 1.4; }
        .si-score { font-size: 1.1rem; font-weight: 800; color: white; margin-left: auto; align-self: center; }

        /* --- ESTILO UNIFICADO: RANKING Y NOTICIAS --- */
        .card-style-magazine {
            background: var(--surface); 
            border: 1px solid var(--border); 
            border-radius: 10px; 
            padding: 15px; 
            margin-bottom: 12px; 
            position: relative; 
            overflow: hidden; 
            display: flex;
            flex-direction: column;
            justify-content: center;
            min-height: 70px;
            transition: 0.2s;
            text-decoration: none;
            border-left: 4px solid #333; 
        }
        
        .card-watermark {
            position: absolute; right: -20px; top: -15px; width: 130px; height: 130px;
            opacity: 0.1; transform: rotate(-15deg); object-fit: contain; pointer-events: none; z-index: 0;
        }

        /* NOTICIAS */
        .news-card { display: block; min-height: 90px; }
        .news-tag { 
            font-size: 0.6rem; font-weight: 900; text-transform: uppercase; padding: 2px 6px; 
            border-radius: 4px; margin-bottom: 6px; display: inline-block; width: fit-content; z-index: 2; position: relative;
        }
        .news-card[data-type="PARTIDO"] .news-tag { background: rgba(255, 215, 0, 0.2); color: var(--gold); }
        .news-card[data-type="NOTICIA"] .news-tag { background: rgba(255, 255, 255, 0.1); color: #aaa; }
        .news-title { color: white; font-weight: 700; font-size: 0.95rem; margin-bottom: 6px; line-height: 1.4; z-index: 2; position: relative; }
        .news-meta { color: #777; font-size: 0.75rem; display: flex; justify-content: space-between; align-items: center; z-index: 2; position: relative; }

        /* LIDERES SEASON */
        .leaders-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(100px, 1fr)); gap: 10px; margin-bottom: 25px; }
        .leader-card { background: var(--surface); border-radius: 8px; border: 1px solid #333; overflow: hidden; position: relative; text-align: center; }
        .leader-bg { height: 50px; background: linear-gradient(180deg, var(--tc) 0%, #1e1e1e 100%); opacity: 0.8; }
        .leader-img { width: 60px; height: 60px; object-fit: cover; object-position: top; border-radius: 50%; border: 3px solid #1e1e1e; background: #333; margin-top: -30px; position: relative; z-index: 2; }
        .leader-info { padding: 8px; }
        .leader-name { font-size: 0.75rem; font-weight: 800; color: white; line-height: 1.2; margin-bottom: 4px; }
        .leader-team { font-size: 0.6rem; color: #aaa; text-transform: uppercase; margin-bottom: 6px; }
        .leader-stat { background: #121212; border: 1px solid #333; border-radius: 4px; padding: 4px; display: flex; flex-direction: column; }
        .stat-num { font-size: 0.9rem; font-weight: 900; color: #3b82f6; }
        .stat-lbl { font-size: 0.55rem; color: #777; text-transform: uppercase; }

        /* RANKING REDISE칌ADO (CLEAN) */
        .rank-card { 
            cursor: pointer; 
            flex-direction: row; 
            justify-content: space-between; 
            align-items: center; 
        }
        .rank-left { display: flex; align-items: center; gap: 15px; z-index: 2; }
        .rank-number { 
            font-size: 1.4rem; font-weight: 900; font-style: italic;
            width: 30px; text-align: center; line-height: 1;
        }
        .rank-user-info { display: flex; flex-direction: column; }
        .rank-user-name { font-weight: 800; font-size: 1rem; color: white; }
        .progress-bg { width: 100px; height: 4px; background: rgba(255,255,255,0.1); border-radius: 2px; margin-top: 4px; overflow: hidden; }
        .progress-fill { height: 100%; background: var(--accent); }
        .rank-stats-text { font-size: 0.65rem; color: #aaa; margin-top: 2px; }
        .rank-right { z-index: 2; text-align: right; }
        .rank-pts { background: rgba(0,0,0,0.5); padding: 4px 10px; border-radius: 6px; font-weight: 800; font-size: 0.9rem; color: var(--accent); border: 1px solid #444; }
        .rank-champ-logo { width: 35px; height: 35px; object-fit: contain; filter: drop-shadow(0 2px 5px rgba(0,0,0,0.5)); margin-top: 5px; }

        /* BARRA DE PREDICCION */
        .prediction-box { padding: 20px; border-bottom: 1px solid #333; }
        .pred-title { text-align: center; font-size: 0.7rem; color: #aaa; margin-bottom: 10px; text-transform: uppercase; letter-spacing: 1px; }
        .pred-bar { height: 10px; background: #333; border-radius: 5px; overflow: hidden; display: flex; position: relative; }
        .pred-fill-l { height: 100%; background: var(--team-a-color, #ccc); }
        .pred-fill-r { height: 100%; background: var(--team-b-color, #555); flex: 1; }
        .pred-labels { display: flex; justify-content: space-between; margin-top: 5px; font-size: 0.75rem; font-weight: 700; color: white; }

        /* NAV */
        .bottom-nav { position: fixed; bottom: 0; left: 0; width: 100%; height: var(--nav-height); background: rgba(5, 5, 5, 0.9); backdrop-filter: blur(15px); border-top: 1px solid var(--border); display: flex; justify-content: space-around; align-items: center; z-index: 500; padding-bottom: env(safe-area-inset-bottom); }
        .nav-item { background: none; border: none; color: #555; display: flex; flex-direction: column; align-items: center; font-size: 0.65rem; gap: 5px; width: 20%; height: 100%; justify-content: center; transition: 0.3s;}
        .nav-item i { font-size: 1.3rem; margin-bottom: 2px; transition: 0.3s; }
        .nav-item.active { color: white; }
        .nav-item.active i { color: var(--accent); transform: translateY(-2px); filter: drop-shadow(0 4px 10px rgba(0,230,118,0.5)); }

        .full-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--bg); z-index: 3000; display: none; overflow-y: auto; }
        .modal-nav-bar { position: sticky; top: 0; left: 0; width: 100%; height: 60px; background: rgba(5,5,5,0.9); backdrop-filter: blur(10px); border-bottom: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between; padding: 0 20px; z-index: 50; }
        .modal-back-btn { background: none; border: none; color: white; font-size: 1.1rem; font-weight: bold; cursor: pointer; padding: 0; display: flex; align-items: center; gap: 8px; }
        .modal-title-text { font-weight: 900; color: white; text-transform: uppercase; letter-spacing: 1px; font-size: 1rem; }
        .section-header { padding: 25px 20px 10px 20px; color: #555; font-size: 0.75rem; font-weight: 800; text-transform: uppercase; letter-spacing: 1px; }
        
        @media (max-width: 480px) {
            .team-name { font-size: 0.8rem; }
            .team-row { padding: 6px 8px; height: 46px; }
            .container { padding: 12px; }
        }
    </style>
</head>
<body>

    <header>
        <div class="header-brand">
            <div class="nfl-icon-box"><i class="fa-solid fa-football"></i></div>
            <div class="header-titles">
                <div class="ht-main">PLAYOFFS</div>
                <div class="ht-sub">Temporada 2026</div>
            </div>
        </div>
        <div class="live-pill">
            <div class="live-dot"></div>
            <div class="live-txt">EN JUEGO</div>
        </div>
    </header>

    <div class="container">
        
        <div id="tab-ranking" class="section active">
            <div class="section-header">Clasificaci칩n</div>
            <div id="rankingList"></div>
        </div>

        <div id="tab-results" class="section">
            <div class="section-header">Cuadro Oficial</div>
            <div class="conf-header-row">
                <div class="conf-badge afc-bg"><img src="https://a.espncdn.com/i/teamlogos/nfl/500/afc.png" class="conf-logo-img"></div>
                <div class="conf-badge nfc-bg"><img src="https://a.espncdn.com/i/teamlogos/nfl/500/nfc.png" class="conf-logo-img"></div>
            </div>
            <div id="officialBracket"></div>
        </div>

        <div id="tab-matches" class="section">
            <div class="section-header">Marcadores en Vivo</div>
            <div id="liveGamesList"></div>
        </div>

        <div id="tab-news" class="section">
            <div class="section-header">L칤deres de la Temporada</div>
            <div class="leaders-grid">
                <div class="leader-card" style="--tc: #241773;">
                    <div class="leader-bg"></div>
                    <img src="https://a.espncdn.com/combiner/i?img=/i/headshots/nfl/players/full/3916387.png&w=350&h=254" class="leader-img">
                    <div class="leader-info"><div class="leader-name">Lamar Jackson</div><div class="leader-stat">4,450</div><div class="leader-lbl">YDS PASE</div></div>
                </div>
                <div class="leader-card" style="--tc: #004C54;">
                    <div class="leader-bg"></div>
                    <img src="https://a.espncdn.com/combiner/i?img=/i/headshots/nfl/players/full/3929630.png&w=350&h=254" class="leader-img">
                    <div class="leader-info"><div class="leader-name">Saquon Barkley</div><div class="leader-stat">1,890</div><div class="leader-lbl">YDS CARRERA</div></div>
                </div>
                <div class="leader-card" style="--tc: #4F2683;">
                    <div class="leader-bg"></div>
                    <img src="https://a.espncdn.com/combiner/i?img=/i/headshots/nfl/players/full/4262921.png&w=350&h=254" class="leader-img">
                    <div class="leader-info"><div class="leader-name">Justin Jefferson</div><div class="leader-stat">1,650</div><div class="leader-lbl">YDS REC</div></div>
                </div>
            </div>

            <div class="section-header">Noticias & Actualidad</div>
            <div id="newsList"></div>
        </div>

        <div id="tab-admin" class="section">
            <div style="background:#1a1a1a; padding:30px; border-radius:16px; margin-top:20px; border:1px solid #333;">
                <input type="password" id="adminPass" style="background:#333; border:none; padding:15px; width:100%; color:white; border-radius:8px; margin-bottom:15px;" placeholder="Contrase침a">
                <button onclick="app.adminLogin()" style="background:white; color:black; border:none; padding:15px; width:100%; border-radius:8px; font-weight:800;">ENTRAR</button>
            </div>
            <div id="adminPanel" style="display:none; margin-top:20px;">
                <div id="adminBracket"></div>
                <button onclick="app.adminSave()" style="background:var(--accent); color:white; border:none; padding:15px; width:100%; border-radius:8px; font-weight:800; margin-top:20px;">PUBLICAR CAMBIOS</button>
            </div>
        </div>
    </div>

    <div id="matchModal" class="full-modal">
        <div class="modal-nav-bar">
            <button onclick="document.getElementById('matchModal').style.display='none'" style="background:none; border:none; color:white; font-size:1.2rem;"><i class="fa-solid fa-xmark"></i></button>
            <span style="font-weight:800; color:white;">DETALLES</span>
            <div style="width:20px"></div>
        </div>
        <div id="matchModalContent" style="padding-bottom:100px;"></div>
    </div>

    <div id="viewModal" class="full-modal">
        <div class="modal-nav-bar">
            <button onclick="document.getElementById('viewModal').style.display='none'" style="background:none; border:none; color:white; font-size:1.2rem;"><i class="fa-solid fa-arrow-left"></i></button>
            <span id="viewModalTitle" style="font-weight:800; color:white;">USUARIO</span>
            <div style="width:20px"></div>
        </div>
        <div class="container">
            <div id="viewModalBody" style="padding-top:20px;"></div>
        </div>
    </div>

    <nav class="bottom-nav">
        <button class="nav-item active" onclick="app.nav('ranking')"><i class="fa-solid fa-trophy"></i><span>Ranking</span></button>
        <button class="nav-item" onclick="app.nav('results')"><i class="fa-solid fa-list-ul"></i><span>Cuadro</span></button>
        <button class="nav-item" onclick="app.nav('matches')"><i class="fa-solid fa-stopwatch"></i><span>Partidos</span></button>
        <button class="nav-item" onclick="app.nav('news')"><i class="fa-solid fa-newspaper"></i><span>Noticias</span></button>
        <button class="nav-item" onclick="app.nav('admin')"><i class="fa-solid fa-gear"></i><span>Admin</span></button>
    </nav>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, onValue, set } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        const db = getDatabase(initializeApp({
            apiKey: "AIzaSyCRoM4Fuz5eGGnXSwNYRn-nf8oII_ulLuQ",
            authDomain: "mentiroso-marcos-perez.firebaseapp.com",
            databaseURL: "https://mentiroso-marcos-perez-default-rtdb.europe-west1.firebasedatabase.app/",
            projectId: "mentiroso-marcos-perez",
            storageBucket: "mentiroso-marcos-perez.firebasestorage.app",
            messagingSenderId: "968925541268",
            appId: "1:968925541268:web:97a255db8eeff952b71581"
        }));

        const TEAMS = {
            "Broncos": { s:1, c:"A", color:"#FB4F14", logo: "https://a.espncdn.com/i/teamlogos/nfl/500/den.png" },
            "Patriots": { s:2, c:"A", color:"#002244", logo: "https://a.espncdn.com/i/teamlogos/nfl/500/ne.png" },
            "Jaguars": { s:3, c:"A", color:"#006778", logo: "https://a.espncdn.com/i/teamlogos/nfl/500/jax.png" },
            "Steelers": { s:4, c:"A", color:"#FFB612", logo: "https://a.espncdn.com/i/teamlogos/nfl/500/pit.png" },
            "Texans": { s:5, c:"A", color:"#03202F", logo: "https://a.espncdn.com/i/teamlogos/nfl/500/hou.png" },
            "Bills": { s:6, c:"A", color:"#00338D", logo: "https://a.espncdn.com/i/teamlogos/nfl/500/buf.png" },
            "Chargers": { s:7, c:"A", color:"#0080C6", logo: "https://a.espncdn.com/i/teamlogos/nfl/500/lac.png" },
            "Seahawks": { s:1, c:"N", color:"#69BE28", logo: "https://a.espncdn.com/i/teamlogos/nfl/500/sea.png" },
            "Bears": { s:2, c:"N", color:"#C83803", logo: "https://a.espncdn.com/i/teamlogos/nfl/500/chi.png" },
            "Eagles": { s:3, c:"N", color:"#004C54", logo: "https://a.espncdn.com/i/teamlogos/nfl/500/phi.png" },
            "Panthers": { s:4, c:"N", color:"#0085CA", logo: "https://a.espncdn.com/i/teamlogos/nfl/500/car.png" },
            "Rams": { s:5, c:"N", color:"#003594", logo: "https://a.espncdn.com/i/teamlogos/nfl/500/lar.png" },
            "49ers": { s:6, c:"N", color:"#AA0000", logo: "https://a.espncdn.com/i/teamlogos/nfl/500/sf.png" },
            "Packers": { s:7, c:"N", color:"#203731", logo: "https://a.espncdn.com/i/teamlogos/nfl/500/gb.png" },
            "Chiefs": { s:1, c:"A", color:"#E31837", logo: "https://a.espncdn.com/i/teamlogos/nfl/500/kc.png" },
            "Ravens": { s:1, c:"A", color:"#241773", logo: "https://a.espncdn.com/i/teamlogos/nfl/500/bal.png" }
        };

        const WC_MATCHES = [
            { id: "a1", h: "Patriots", a: "Chargers" }, { id: "a2", h: "Jaguars", a: "Bills" }, { id: "a3", h: "Steelers", a: "Texans" },
            { id: "n1", h: "Bears", a: "Packers" }, { id: "n2", h: "Eagles", a: "49ers" }, { id: "n3", h: "Panthers", a: "Rams" }
        ];

        let state = { db: {}, admin: {}, liveData: [] };

        window.app = {
            init: () => {
                onValue(ref(db), snap => {
                    state.db = snap.val() || {};
                    app.ui();
                });
            },

            ui: () => {
                const realResults = state.db.results || {};
                app.renderRank();
                app.renderSplitBracket('officialBracket', realResults, 'read-official');
            },
            
            nav: (id) => {
                document.querySelectorAll('.section').forEach(e=>e.classList.remove('active'));
                document.getElementById('tab-'+id).classList.add('active');
                document.querySelectorAll('.nav-item').forEach(e=>e.classList.remove('active'));
                event.currentTarget.classList.add('active');
                if(id === 'matches') app.loadLiveGames();
                if(id === 'news') app.loadNews();
            },

            // --- CARGA NOTICIAS "INTELIGENTES" ---
            loadNews: async () => {
                const cont = document.getElementById('newsList');
                if(cont.innerHTML.includes('card-style-magazine')) return; 
                cont.innerHTML = '<div style="text-align:center;padding:30px;color:#666"><i class="fa-solid fa-circle-notch fa-spin" style="font-size:2rem; margin-bottom:10px;"></i><br>Cargando datos en espa침ol...</div>';
                
                try {
                    const res = await fetch('https://api.rss2json.com/v1/api.json?rss_url=https://www.espn.com.mx/espn/rss/nfl/news');
                    const data = await res.json();
                    
                    if(data.status === 'ok') {
                        cont.innerHTML = '';
                        data.items.slice(0, 10).forEach(item => {
                            const date = new Date(item.pubDate).toLocaleDateString('es-ES', {day:'numeric', month:'short'});
                            const title = item.title;
                            let type = 'NOTICIA';
                            if(title.toLowerCase().includes('vs') || title.toLowerCase().includes('gana') || title.toLowerCase().includes('vence')) {
                                type = 'PARTIDO';
                            }
                            
                            // Detectar equipo
                            let teamColor = '#444';
                            let teamLogo = '';
                            let hasTeam = false;
                            
                            for (const [key, val] of Object.entries(TEAMS)) {
                                if (title.includes(key)) {
                                    teamColor = val.color;
                                    teamLogo = val.logo;
                                    hasTeam = true;
                                    break;
                                }
                            }
                            
                            let style = `border-left: 5px solid ${teamColor};`;
                            if(hasTeam) {
                                style += `background: linear-gradient(135deg, var(--surface) 30%, ${teamColor}20 100%);`;
                            }
                            
                            let watermark = hasTeam ? `<img src="${teamLogo}" class="card-watermark">` : '';

                            cont.innerHTML += `
                                <a href="${item.link}" target="_blank" class="card-style-magazine news-card" data-type="${type}" style="${style}">
                                    ${watermark}
                                    <span class="news-tag">${type}</span>
                                    <div class="news-title">${title}</div>
                                    <div class="news-meta"><span class="news-source">ESPN DEPORTES</span><span>${date}</span></div>
                                </a>
                            `;
                        });
                    } else {
                        cont.innerHTML = '<div style="text-align:center;padding:20px;">Sin conexi칩n.</div>';
                    }
                } catch(e) {
                    cont.innerHTML = '<div style="text-align:center;padding:20px;">Error al cargar datos.</div>';
                }
            },

            loadLiveGames: async () => {
                const c = document.getElementById('liveGamesList');
                c.innerHTML = '<div class="ph-box"><i class="fa-solid fa-sync fa-spin"></i> Conectando con ESPN...</div>';
                
                try {
                    const res = await fetch('https://site.api.espn.com/apis/site/v2/sports/football/nfl/scoreboard');
                    const data = await res.json();
                    state.liveData = data.events || [];

                    if(state.liveData.length === 0) {
                        c.innerHTML = '<div class="ph-box">No hay partidos programados para hoy.</div>';
                        return;
                    }

                    c.innerHTML = '';
                    state.liveData.forEach((evt, idx) => {
                        const comp = evt.competitions[0];
                        const team1 = comp.competitors[1]; // Home
                        const team2 = comp.competitors[0]; // Away
                        const status = evt.status.type.state; // pre, in, post
                        const statusDetail = evt.status.type.detail;
                        const score1 = team1.score;
                        const score2 = team2.score;

                        let statusClass = '';
                        if(status === 'in') statusClass = 'in-progress';

                        // Traducir estados simples
                        let statusText = statusDetail.replace('Final', 'FINAL').replace('OT', 'PR칍RROGA');
                        if(status === 'pre') {
                            const d = new Date(evt.date);
                            statusText = d.toLocaleTimeString('es-ES', {hour:'2-digit', minute:'2-digit'});
                        }

                        // SITUACION DE JUEGO EN LISTA
                        let situationHtml = '';
                        let cardClass = 'live-card';
                        
                        if(status === 'in' && comp.situation) {
                            if(comp.situation.isRedZone) {
                                cardClass += ' red-zone-active';
                                situationHtml = '<span class="game-situation red-zone-text">游뚿 ZONA ROJA</span>';
                            } else if(comp.situation.down > 0) {
                                situationHtml = `<span class="game-situation">${comp.situation.down}춹 y ${comp.situation.distance}</span>`;
                            }
                        }

                        const card = document.createElement('div');
                        card.className = cardClass;
                        card.onclick = () => app.openMatchModal(idx);
                        card.innerHTML = `
                            <div class="live-header">
                                <span>${evt.name}</span>
                                <div style="display:flex; align-items:center;">
                                    ${situationHtml}
                                    <span class="live-status ${statusClass}">${statusText}</span>
                                </div>
                            </div>
                            <div class="live-body">
                                <div class="live-team">
                                    <img src="${team1.team.logo}" class="live-logo">
                                    <span class="live-name">${team1.team.abbreviation}</span>
                                </div>
                                <div class="live-score-col">
                                    ${status === 'pre' ? '<span class="live-vs">VS</span>' : `<span class="live-score">${score1} - ${score2}</span>`}
                                </div>
                                <div class="live-team">
                                    <img src="${team2.team.logo}" class="live-logo">
                                    <span class="live-name">${team2.team.abbreviation}</span>
                                </div>
                            </div>
                        `;
                        c.appendChild(card);
                    });

                } catch(e) {
                    c.innerHTML = '<div class="ph-box">Error cargando partidos.</div>';
                }
            },

            openMatchModal: async (idx) => {
                const evt = state.liveData[idx];
                const gameId = evt.id;
                const modal = document.getElementById('matchModal');
                const content = document.getElementById('matchModalContent');
                
                content.innerHTML = '<div style="text-align:center;padding:50px;color:#888;"><i class="fa-solid fa-football fa-spin"></i><br>Obteniendo jugadas...</div>';
                modal.style.display = 'block';

                try {
                    const res = await fetch(`https://site.api.espn.com/apis/site/v2/sports/football/nfl/summary?event=${gameId}`);
                    const detailed = await res.json();
                    
                    const comp = detailed.header.competitions[0];
                    const home = comp.competitors[1];
                    const away = comp.competitors[0];
                    const venue = detailed.gameInfo ? detailed.gameInfo.venue.fullName : 'Estadio';
                    const statusState = detailed.header.competitions[0].status.type.state; // 'pre', 'in', 'post'
                    
                    let scoreDisplay = "";
                    let timeStr = "";
                    if(statusState === 'pre') {
                        const gameDate = new Date(detailed.header.competitions[0].date);
                        timeStr = gameDate.toLocaleTimeString('es-ES', {hour:'2-digit', minute:'2-digit'});
                        scoreDisplay = `<span class="mm-score pre-game">${timeStr}</span>`;
                    } else {
                        scoreDisplay = `<div class="mm-score">${home.score || 0} - ${away.score || 0}</div>`;
                    }

                    const getLogo = (t) => (t.team.logos && t.team.logos[0] && t.team.logos[0].href) || t.team.logo || 'https://a.espncdn.com/i/teamlogos/nfl/500/nfl.png';
                    const homeLogo = getLogo(home);
                    const awayLogo = getLogo(away);

                    let possessionTeamId = null;
                    if(statusState === 'in' && detailed.header.competitions[0].situation && detailed.header.competitions[0].situation.possession) {
                        possessionTeamId = detailed.header.competitions[0].situation.possession;
                    }
                    const homeClass = (possessionTeamId === home.id) ? 'has-possession' : '';
                    const awayClass = (possessionTeamId === away.id) ? 'has-possession' : '';

                    let homePct = 55; let awayPct = 45;
                    if(detailed.predictor) {
                        homePct = detailed.predictor.homeTeam.gameProjection;
                        awayPct = 100 - homePct;
                    }

                    // --- LAST PLAY (ULTIMA JUGADA) ---
                    let lastPlayHtml = '';
                    if(detailed.drives && detailed.drives.current && detailed.drives.current.plays && detailed.drives.current.plays.length > 0) {
                        const plays = detailed.drives.current.plays;
                        const lastPlay = plays[plays.length - 1];
                        lastPlayHtml = `
                            <div class="last-play-box">
                                <div class="lp-label">칔LTIMA JUGADA</div>
                                <div class="lp-text">${lastPlay.text}</div>
                            </div>
                        `;
                    }

                    // --- GENERACI칍N DE CONTENIDO CONDICIONAL ---
                    let bottomContent = '';

                    if(statusState === 'pre') {
                        // SI ES PREVIA: Solo mostrar hora y ocultar lideres/anotaciones
                        bottomContent = `
                            <div style="text-align:center; padding:30px; color:#666;">
                                <i class="fa-regular fa-clock" style="font-size:2rem; margin-bottom:10px;"></i>
                                <div>El partido comienza a las <b>${timeStr}</b></div>
                                <div style="font-size:0.7rem; margin-top:5px;">Las estad칤sticas estar치n disponibles al inicio.</div>
                            </div>
                        `;
                    } else {
                        // SI ESTA EN JUEGO O FINALIZADO: Mostrar todo
                        let scoringHtml = '';
                        if(detailed.scoringPlays && detailed.scoringPlays.length > 0) {
                            detailed.scoringPlays.forEach(play => {
                                const teamLogo = (play.team && play.team.logo) || 'https://a.espncdn.com/i/teamlogos/nfl/500/nfl.png';
                                // Mini traductor
                                let text = play.text.replace('Touchdown', 'Touchdown').replace('Field Goal', 'Gol de Campo').replace('Safety', 'Safety').replace('pass', 'pase').replace('run', 'carrera').replace('good', 'bueno');
                                
                                let typeText = play.type ? play.type.text : "Anotaci칩n";
                                let badgeClass = '', badgeLabel = 'PUNTOS';
                                if(typeText.includes('Touchdown')) { badgeClass = 'tag-td'; badgeLabel = 'TOUCHDOWN'; }
                                else if(typeText.includes('Field Goal')) { badgeClass = 'tag-fg'; badgeLabel = 'GOL DE CAMPO'; }
                                else if(typeText.includes('Safety')) { badgeClass = 'tag-sf'; badgeLabel = 'SAFETY'; }

                                scoringHtml += `
                                    <div class="scoring-item">
                                        <img src="${teamLogo}" class="si-logo">
                                        <div class="si-content">
                                            <div class="si-time">${play.clock.displayValue} - Q${play.period.number}</div>
                                            <div style="margin-bottom:4px;"><span class="score-tag ${badgeClass}">${badgeLabel}</span></div>
                                            <div class="si-desc">${text}</div>
                                        </div>
                                        <div class="si-score">${play.homeScore}-${play.awayScore}</div>
                                    </div>`;
                            });
                        } else { scoringHtml = '<div style="text-align:center;color:#666;padding:20px;">Sin anotaciones a칰n.</div>'; }

                        // LIDERES DE PARTIDO Y STATS DE EQUIPO ELIMINADOS, SOLO ANOTACIONES

                        bottomContent = `
                            ${lastPlayHtml}
                            <div class="section-header">Anotaciones</div>
                            <div class="scoring-list">${scoringHtml}</div>
                        `;
                    }

                    // RENDER FINAL DEL MODAL
                    content.innerHTML = `
                        <div class="match-modal-header">
                            <div style="font-size:0.8rem; color:#aaa; margin-bottom:10px;">${venue}</div>
                            <div class="mm-score-board">
                                <div style="text-align:center" class="${homeClass}">
                                    <img src="${homeLogo}" class="mm-logo-big">
                                    <i class="fa-solid fa-football-ball ball-icon"></i>
                                    <div style="font-weight:900; font-size:1.5rem; margin-top:10px;">${home.team.abbreviation}</div>
                                </div>
                                ${scoreDisplay}
                                <div style="text-align:center" class="${awayClass}">
                                    <img src="${awayLogo}" class="mm-logo-big">
                                    <i class="fa-solid fa-football-ball ball-icon"></i>
                                    <div style="font-weight:900; font-size:1.5rem; margin-top:10px;">${away.team.abbreviation}</div>
                                </div>
                            </div>
                        </div>
                        <div class="mm-meta">Estado: <span style="color:#fff; font-weight:bold">${detailed.header.competitions[0].status.type.detail}</span></div>
                        
                        <div class="prediction-box">
                            <div class="pred-title">Probabilidad de Victoria (ESPN Analytics)</div>
                            <div class="pred-bar" style="--team-a-color: #${home.team.color}; --team-b-color: #${away.team.color}">
                                <div class="pred-fill-l" style="width:${homePct}%"></div><div class="pred-fill-r"></div>
                            </div>
                            <div class="pred-labels"><span style="color:#${home.team.color}">${Math.round(homePct)}% ${home.team.name}</span><span style="color:#${away.team.color}">${Math.round(awayPct)}% ${away.team.name}</span></div>
                        </div>
                        
                        ${bottomContent}
                    `;

                } catch(e) {
                    console.log(e);
                    content.innerHTML = '<div style="text-align:center;padding:20px;">Error cargando detalles del partido.</div>';
                }
            },

            calcTree: (p) => {
                p=p||{}; let wc={A:[],N:[]}; WC_MATCHES.forEach(m=>{if(p[m.id])wc[TEAMS[p[m.id]].c].push(p[m.id])});
                let div=[]; ['A','N'].forEach(c=>{ if(wc[c].length===3){let s1=Object.keys(TEAMS).find(t=>TEAMS[t].c===c&&TEAMS[t].s===1); let pl=[s1,...wc[c]].sort((a,b)=>TEAMS[a].s-TEAMS[b].s); div.push({id:`${c}d1`,h:pl[0],a:pl[3],c:c},{id:`${c}d2`,h:pl[1],a:pl[2],c:c});}else{div.push({id:`${c}d1`,ph:true,c:c},{id:`${c}d2`,ph:true,c:c});}});
                let conf=[]; let dw={A:[],N:[]}; div.forEach(m=>{if(!m.ph&&p[m.id]&&(p[m.id]===m.h||p[m.id]===m.a))dw[m.c].push(p[m.id])});
                ['A','N'].forEach(c=>{ if(dw[c].length===2){let s=dw[c].sort((a,b)=>TEAMS[a].s-TEAMS[b].s); conf.push({id:`${c}c`,h:s[0],a:s[1],c:c});}else{conf.push({id:`${c}c`,ph:true,c:c});}});
                let sb={id:'sb',ph:true}, ma=conf.find(m=>m.c==='A'), mn=conf.find(m=>m.c==='N'), ac=(ma&&!ma.ph&&p[ma.id])?p[ma.id]:null, nc=(mn&&!mn.ph&&p[mn.id])?p[mn.id]:null;
                if(ac&&nc)sb={id:'sb',h:ac,a:nc}; let ch=null; if(!sb.ph&&p['sb'])ch=p['sb'];
                return {wc:WC_MATCHES,div,conf,sb,ch};
            },
            
            renderSplitBracket: (cid, src, mode) => {
                const t=app.calcTree(src), c=document.getElementById(cid), rr=state.db.results||{}, rounds=[{t:'Wild Card',d:t.wc},{t:'Divisional',d:t.div},{t:'Conference',d:t.conf}]; c.innerHTML='';
                rounds.forEach(rnd=>{
                    const w=document.createElement('div'); w.className='round-wrapper'; w.innerHTML=`<div class="round-title">${rnd.t}</div>`;
                    const g=document.createElement('div'); g.className='matches-grid'; const cA=document.createElement('div'), cN=document.createElement('div');
                    rnd.d.forEach(m=>{
                        let isA=m.ph?(m.c==='A'):(TEAMS[m.h].c==='A'); let trg=isA?cA:cN;
                        if(m.ph) trg.innerHTML+='<div class="ph-box">Por definir...</div>';
                        else {
                            const cd=document.createElement('div'); cd.className='match-card';
                            [m.h,m.a].forEach(tm=>{
                                const d=TEAMS[tm], sel=src[m.id]===tm, win=rr[m.id]===tm, fin=(rr[m.id]&&TEAMS[rr[m.id]]);
                                const r=document.createElement('div'); let cl='team-row '; let ic='';
                                if(mode==='read-official'){ if(sel){cl+='active-team winner-green '; ic='<i class="fa-solid fa-trophy status-icon icon-check"></i>';} }
                                else if(mode==='read'){ if(sel){ if(fin){ if(win){cl+='active-team winner-green '; ic='<i class="fa-solid fa-check status-icon icon-check"></i>';}else{cl+='eliminated '; ic='<i class="fa-solid fa-xmark status-icon icon-cross"></i>';} }else{cl+='active-team ';} }else if(win){cl+='active-team winner-green ';} }
                                else { if(sel) cl+='active-team '; }
                                r.className=cl; r.style.setProperty('--team-color',d.color); r.style.setProperty('--team-color-alpha',d.color+'40');
                                r.innerHTML=`<span class="team-seed">${d.s}</span><img src="${d.logo}" class="team-logo"><span class="team-name">${tm}</span>${ic}`;
                                if(mode==='admin') r.onclick=()=>{src[m.id]=tm; app.renderSplitBracket(cid,src,mode)};
                                cd.appendChild(r);
                            });
                            trg.appendChild(cd);
                        }
                    });
                    g.appendChild(cA); g.appendChild(cN); w.appendChild(g); c.appendChild(w);
                });
                const w=document.createElement('div'); w.className='round-wrapper'; w.innerHTML=`<div class="round-title">Super Bowl</div>`;
                const sg=document.createElement('div'); sg.className='sb-grid';
                if(t.sb.ph) sg.innerHTML='<div class="ph-box" style="width:100%">Por definir...</div>';
                else {
                    const cd=document.createElement('div'); cd.className='match-card sb-card';
                    [t.sb.h,t.sb.a].forEach(tm=>{
                        const d=TEAMS[tm], sel=src.sb===tm, win=rr.sb===tm, fin=(rr.sb&&TEAMS[rr.sb]);
                        const r=document.createElement('div'); let cl='team-row '; let ic='';
                        if(mode==='read-official'){ if(sel){cl+='active-team winner-green '; ic='<i class="fa-solid fa-star status-icon" style="color:#ffd700"></i>';} }
                        else if(mode==='read'){ if(sel){ if(fin){ if(win){cl+='active-team winner-green '; ic='<i class="fa-solid fa-check status-icon icon-check"></i>';}else{cl+='eliminated '; ic='<i class="fa-solid fa-xmark status-icon icon-cross"></i>';} }else{cl+='active-team ';} }else if(win){cl+='active-team winner-green ';} }
                        else { if(sel) cl+='active-team '; }
                        r.className=cl; r.style.setProperty('--team-color',d.color); r.style.setProperty('--team-color-alpha',d.color+'60');
                        r.innerHTML=`<span class="team-seed">${d.s}</span><img src="${d.logo}" class="team-logo"><span class="team-name">${tm}</span>${ic}`;
                        if(mode==='admin') r.onclick=()=>{src.sb=tm; app.renderSplitBracket(cid,src,mode)};
                        cd.appendChild(r);
                    });
                    sg.appendChild(cd);
                }
                w.appendChild(sg); c.appendChild(w);
                if(t.ch && mode!=='admin'){
                    const d=TEAMS[t.ch];
                    const wd=document.createElement('div'); wd.style.cssText="text-align:center; margin-top:20px; padding:20px; background:linear-gradient(135deg, rgba(0,0,0,0.4), rgba(234, 179, 8, 0.1)); border:1px solid #eab308; border-radius:12px;";
                    wd.innerHTML=`<small style="color:#eab308; font-weight:800; letter-spacing:2px;">CAMPE칍N</small><br><img src="${d.logo}" style="width:70px; margin-top:15px;"><h2 style="margin:10px 0 0 0; color:white;">${t.ch}</h2>`;
                    c.appendChild(wd);
                }
            },

            renderRank: () => {
                const l=document.getElementById('rankingList'); if(!state.db.users){l.innerHTML="<div class='ph-box'>Cargando...</div>";return}
                const rr=state.db.results||{}, scores=[], rt=app.calcTree(rr);
                let tp=0; WC_MATCHES.forEach(m=>{if(rr[m.id]&&TEAMS[rr[m.id]])tp++}); rt.div.forEach(m=>{if(!m.ph&&rr[m.id])tp++}); rt.conf.forEach(m=>{if(!m.ph&&rr[m.id])tp++}); if(rt.ch)tp++;
                
                Object.keys(state.db.users).forEach(u=>{
                    const p=state.db.users[u].picks||{}; let pts=0, h=0, ut=app.calcTree(p);
                    WC_MATCHES.forEach(m=>{if(rr[m.id]&&p[m.id]===rr[m.id]){pts+=2;h++}});
                    const chk=(r,u)=>{if(!r||!u||r.ph||u.ph)return false; return [r.h,r.a].sort().join('-')===[u.h,u.a].sort().join('-')};
                    rt.div.forEach(m=>{ let um=ut.div.find(x=>x.id===m.id); if(chk(m,um))pts+=1; if(rr[m.id]&&p[m.id]===rr[m.id]){pts+=3;h++} });
                    rt.conf.forEach(m=>{ let um=ut.conf.find(x=>x.id===m.id); if(chk(m,um))pts+=1; if(rr[m.id]&&p[m.id]===rr[m.id]){pts+=4;h++} });
                    if(chk(rt.sb,ut.sb))pts+=1; if(rt.ch&&ut.ch===rt.ch){pts+=5;h++}
                    scores.push({name:u,pts,h,winner:ut.ch});
                });
                scores.sort((a,b)=>b.pts-a.pts);
                
                l.innerHTML='';
                scores.forEach((s,i)=>{
                    const d=document.createElement('div');
                    
                    // ESCUDO ESTILO NOTICIAS
                    const champTeam = s.winner ? TEAMS[s.winner] : null;
                    const teamColor = champTeam ? champTeam.color : '#444';
                    const teamLogo = champTeam ? champTeam.logo : '';
                    const hasWinner = champTeam ? true : false;
                    
                    // Estilo din치mico si tiene ganador
                    let rowStyle = hasWinner ? 
                        `background: linear-gradient(135deg, var(--surface) 30%, ${teamColor}20 100%); border-left: 5px solid ${teamColor};` 
                        : 'border-left: 5px solid #333;';
                    
                    let champHtml = hasWinner ? 
                        `<img src="${teamLogo}" class="rank-champ-logo">` 
                        : '';

                    d.className='card-style-magazine rank-card';
                    d.style.cssText = rowStyle;

                    let percent = tp > 0 ? (s.h / tp) * 100 : 0;

                    d.innerHTML=`
                        ${hasWinner ? `<img src="${teamLogo}" class="card-watermark">` : ''}
                        <div class="rank-left">
                            <div class="rank-number" style="color:${i===0? 'var(--gold)' : (i===1? '#c0c0c0' : (i===2? '#cd7f32' : '#666'))}">${i+1}</div>
                            <div class="rank-user-info">
                                <span class="rank-user-name">${s.name}</span>
                                <div class="progress-bg"><div class="progress-fill" style="width:${percent}%"></div></div>
                                <span class="rank-stats-text">${s.h}/${tp} Aciertos</span>
                            </div>
                        </div>
                        <div class="rank-right">
                            <span class="rank-pts">${s.pts} pts</span>
                        </div>
                    `;
                    d.onclick=()=>{ document.getElementById('viewModal').style.display='block'; document.getElementById('viewModalTitle').innerText=s.name; app.renderSplitBracket('viewModalBody',state.db.users[s.name].picks||{},'read'); };
                    l.appendChild(d);
                });
            },
            
            adminLogin:()=>{ if(document.getElementById('adminPass').value==='123Marcos'){ document.getElementById('adminPanel').style.display='block'; state.admin=state.db.results||{}; app.renderSplitBracket('adminBracket',state.admin,'admin'); } },
            adminSave:()=>{ if(confirm("쮾uardar Oficiales?")) set(ref(db,'results'),state.admin); }
        };
        app.init();
    </script>
</body>
</html>
